{% extends 'index.html' %}
{% load crispy_forms_tags %}
{% block title %}Chat auta{% endblock %}

{% block content %}
<h4>Chat pasażerów auta {{ car.owner.first_name }}</h4>
<br>
<h4>Aktualni pasażerowie:</h4>
{% for passenger in car_chat.users.all %}
    <a href="{% url 'profile' passenger.id %}" class="caption-link btn btn-default">{{ passenger.first_name }}</a>
{% endfor %}
<br>
<br>
{% if messagess %}
    {% if messagess|length > 10 %}
    {% endif %}
    <div class="table-responsive">
        <table class="table table-hover">
          <tbody>
            {% for message in messagess %}
            <tr>
              <th scope="row" style="text-align:right">{{ message.created }} <b>{{ message.user.first_name }}: </b></th>
              <td style="text-align:left" width="60%">{{ message.comment }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
</div>
{% else %}
    Brak wiadomości
{% endif %}
<br>
<hr>
<br>
                    <form method="POST">
                        {% csrf_token %}
        {{ message_form|crispy }}
<input type="submit" value="Wyślij" class="caption-link btn btn-default"/>
</form>
<br>

<script>
    window.setTimeout(function () {
    location.href = "{% url 'chat_car_all_message' car_chat.car.id %}";
}, 30000); // refresh/redirect after 30 seconds.
</script>
{% endblock %}